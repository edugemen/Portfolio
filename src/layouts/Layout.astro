---
import NavBar from "../components/NavBar.astro";
import { $selectedLanguage } from "../lang/utils";
interface Props {
    title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang={$selectedLanguage.get()}>
    <head>
        <meta charset="UTF-8" />
        <meta name="description" content="Astro description" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="generator" content={Astro.generator} />
        <title>{title}</title>
    </head>
    <body>
        <NavBar />
        <slot />
    </body>
</html>

<script>
    import { languages, type Language, $selectedLanguage } from "../lang/utils";

    let lang = navigator.language.split("-")[0] as Language;

    if (languages[lang] === undefined) {
        lang = "es";
    }

    $selectedLanguage.listen((newLang) => {
        lang = newLang;
        document.querySelector("html")?.setAttribute("lang", lang);
    });

    const cards = Array.from(document.querySelectorAll(".card__container"));

    cards.forEach((card) => {
        if (card instanceof HTMLElement) {
            const x = card.offsetLeft;
            const y = card.offsetTop;

            card.setAttribute("style", `--xx: ${x}px; --yy:${y}px;`);
        }
    });

    addEventListener("resize", (e) => {
        cards.forEach((card) => {
            if (card instanceof HTMLElement) {
                const x = card.offsetLeft;
                const y = card.offsetTop;

                card.setAttribute("style", `--xx: ${x}px; --yy:${y}px;`);
            }
        });
    });

    const applyOverlayMask = (e: any) => {
        const overlayEl = e.currentTarget;
        const x = e.pageX;
        const y = e.pageY;

        overlayEl.style = `--opacity: 1; --x: ${x}px; --y:${y}px;`;
    };

    document.body.addEventListener("pointermove", applyOverlayMask);
</script>

<style is:global>
    @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap");

    :root {
        --accent: 158, 76%, 53%;
        --accent-light: 224, 204, 250;
        --accent-dark: 49, 10, 101;
        --accent-gradient: linear-gradient(
            45deg,
            rgb(var(--accent)),
            rgb(var(--accent-light)) 30%,
            white 60%
        );
    }
    html {
        font-family: "Inter", sans-serif;
        background: #13151a;
        background-size: 224px;
    }
    code {
        font-family:
            Menlo,
            Monaco,
            Lucida Console,
            Liberation Mono,
            DejaVu Sans Mono,
            Bitstream Vera Sans Mono,
            Courier New,
            monospace;
    }
    body {
        position: relative;
    }
</style>
